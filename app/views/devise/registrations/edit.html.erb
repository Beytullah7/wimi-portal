<%= bootstrap_devise_error_messages! %>
<div class="panel panel-default">
  <div class="panel-heading">
    <h4><%= t('.title', :resource => resource_class.model_name.human , :default => "Edit #{resource_name.to_s.humanize}") %></h4>
  </div>
  <div class="panel-body">
    <%= form_for(resource, :as => resource_name, :url => registration_path(resource_name), :html => { :method => :put }) do |f| %>
      <div class="form-group">
        <%= f.label :email %>
        <%= f.email_field :email, autofocus: true, class: "form-control" %>
      </div>
      <div class="form-group">
        <%= f.label :password %> <i>(<%= t('.leave_blank_if_you_don_t_want_to_change_it', :default => "leave blank if you don't want to change it") %>)</i><br />
        <%= f.password_field :password, :autocomplete => "off", class: "form-control" %>
      </div>
      <div class="form-group">
        <%= f.label :password_confirmation %><br />
        <%= f.password_field :password_confirmation, class: "form-control"  %>
      </div>
      <div class="form-group">
        <%= f.label :current_password %> <i>(<%= t('.we_need_your_current_password_to_confirm_your_changes', :default => 'we need your current password to confirm your changes') %>)</i>
        <%= f.password_field :current_password, class: "form-control" %>
      </div>
      <%= f.submit t('.update', :default => "Update"), class: "btn btn-primary" %>
    <% end %>
  </div>
</div>

<div class="panel panel-default">
  <div class="panel-heading">
    <h4><%= t("Requests and Documents") %></h4>
  </div>
  <%= form_for(resource, :as => resource_name, :url => registration_path(resource_name), :html => { :method => :put }) do |f| %>
    <div class="panel-body">
      <div class="panel panel-default">
        <div class="panel-heading">
          <%=f.label :holiday %>
        </div>
        <div class="panel-body">
          <div class="form-group">
            <%= f.label "Remaining Leave: #{current_user.remaining_leave.to_s} days " %>
            <%# if (current_user.remaining_leave_last_year > 0 ) %>
              <%= f.label "(thereof #{current_user.remaining_leave_last_year.to_s} from #{Date.today.year-1})" %>
              <%= link_to t('.editLeave', :default => t("helpers.links.editLeave")),
                            holiday_edit_leave_path(current_user), :class => 'btn btn-default btn-xs' %><br>
              <% if (Date.today <= Date.new(Date.today.year, 3, 31)) %>
                <%= f.label "WARNING LABEL"%><br>
              <% end %>
            <%# end %>
          </div>
          <div class="form-group">
            <table class="table table-striped">
              <thead>
                <tr>
                  <th><%=t '.duration' %></th>
                  <th><%=t '.start' %></th>
                  <th><%=t '.end' %></th>
                  <th><%=t '.status' %></th>
                  <th><%=t '.actions', :default => t("helpers.actions") %></th>
                </tr>
              </thead>
              <tbody>
                <% current_user.holidays.each do |holiday| %>
                  <tr>
                    <td><%= holiday.duration %><%= t(" days") %></td>
                    <td><%= holiday.start %></td>
                    <td><%=l holiday.end %></td>
                    <td><%= holiday.status %></td>
                    <td>
                      <%= link_to t('.showDetails', :default => t("helpers.links.edit")),
                                  holiday_path(holiday), :class => 'btn btn-default btn-xs' %>
                      <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
                                  holiday_path(holiday),
                                  :method => :delete,
                                  :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
                                  :class => 'btn btn-xs btn-danger' %>
                    </td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
          <div class="form-group"> 
            <%=link_to t('.request_holiday'), new_holiday_path, class: "btn btn-primary" %><br><br>
            <% current_user.holidays.each do |holiday| %>
              <%= link_to holiday.status, holiday_path(holiday.id)%>
              <br>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  <% end %>
</div>

<p><%= t('.unhappy', :default => 'Unhappy') %>? <%= link_to t('.cancel_my_account', :default => "Cancel my account"), registration_path(resource_name), :data => { :confirm => t('.are_you_sure', :default => "Are you sure?") }, :method => :delete %>.</p>

<%= link_to t('.back', :default => 'Back'), :back %>
